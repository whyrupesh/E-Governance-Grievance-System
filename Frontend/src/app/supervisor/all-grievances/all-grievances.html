@if (error) {
<div class="error-box">
    {{ error }}
</div>
}
@if(filteredGrievances().length === 0) {
<div class="no-data-box">
    <mat-icon>info</mat-icon>
    <p>No grievances found matching the selected filters.</p>
    <button mat-stroked-button color="primary" (click)="resetFilters()">
        Reset Filters
    </button>
</div>
}

@if (filteredGrievances().length > 0) {

<div class="container fade-in">

    <!-- Header -->
    <div class="page-header">
        <div>
            <h2 class="title">All Grievances</h2>
            <p class="subtitle">Supervisor view of submitted grievances</p>
        </div>
    </div>

    <!-- Filters -->
    <div class="filter-card">
        <div class="filter-group">
            <label>Escalated</label>
            <select [ngModel]="filters().escalated" (ngModelChange)="updateEscalated($event)">
                <option value="">All</option>
                <option value="true">Escalated Only</option>
                <option value="false">Normal Priority</option>
            </select>
        </div>

        <div class="filter-group">
            <label>Department</label>
            <select [ngModel]="filters().department" (ngModelChange)="updateDepartment($event)">
                <option value="">All</option>
                @for (d of departments(); track d) {
                <option [value]="d">{{ d }}</option>
                }
            </select>
        </div>

        <div class="filter-group">
            <label>Status</label>
            <select [ngModel]="filters().status" (ngModelChange)="updateStatus($event)">
                <option value="">All</option>
                @for (s of statuses(); track s) {
                <option [value]="s">{{ s }}</option>
                }
            </select>
        </div>

        <div class="filter-group">
            <label>Sort by Date</label>
            <select [ngModel]="sortOrder()" (ngModelChange)="updateSort($event)">
                <option value="desc">Newest First</option>
                <option value="asc">Oldest First</option>
            </select>

        </div>
    </div>

    <!-- Table -->
    <div class="table-card">
        <table class="grievance-table">
            <thead>
                <tr>
                    <th>Grievance #</th>
                    <th>Escalated</th>
                    <th>Department</th>
                    <th>Status</th>
                    <th>Created</th>
                    <th class="action-col">Action</th>
                </tr>
            </thead>

            <tbody>
                @for (g of paginatedGrievances(); track g.grievanceNumber) {
                <tr>
                    <td class="mono">{{ g.grievanceNumber }}</td>
                    <td>
                        @if (g.isEscalated) {
                        <div class="escalated-badge" style="display: flex; align-items: center;">
                            <mat-icon class="alert-icon" style="color: red;">warning</mat-icon>
                            <span>Escalated</span>
                        </div>
                        } @else {
                        <span class="text-neutral">No</span>
                        }
                    </td>
                    <td>{{ g.department }}</td>

                    <td>
                        <span class="status-badge {{ g.status.toLowerCase() }}">
                            {{ g.status }}
                        </span>
                    </td>

                    <td>{{ g.createdAt | date:'mediumDate' }}</td>

                    <td class="action-col">
                        <button class="view-btn" [routerLink]="['/supervisor/detail', g.id]">
                            View
                        </button>
                    </td>
                </tr>
                }
            </tbody>
        </table>

        <!-- Pagination -->
        <mat-paginator [length]="filteredGrievances().length" [pageSize]="pageSize()"
            [pageSizeOptions]="[5, 10, 25, 50]" (page)="handlePageEvent($event)" showFirstLastButtons
            aria-label="Select page">
        </mat-paginator>
    </div>

</div>
}