@if (grievance()) {
<div class="detail-container fade-in">

  <!-- HEADER CARD -->
  <mat-card class="header-card">
    <div class="header-row">
      <div>
        <h2>
          Grievance #{{ grievance()!.grievanceNumber }}
        </h2>

        <span class="status-pill {{ grievance()!.status.toLowerCase() }}">
          {{ grievance()!.status }}
        </span>
      </div>

      <div class="escalate-box">
        <span class="label">Escalated</span>
        <mat-slide-toggle
          color="warn"
          [checked]="grievance()!.isEscalated"
          [disabled]="grievance()!.status === 'Closed'"
          (change)="onEscalateToggle()">
        </mat-slide-toggle>
      </div>
    </div>
  </mat-card>

  <!-- DETAILS -->
  <mat-card class="info-card">
    <div class="info-grid">
      <div class="info-item">
        <label>Category</label>
        <span>{{ grievance()!.category }}</span>
      </div>

      <div class="info-item">
        <label>Department</label>
        <span>{{ grievance()!.department }}</span>
      </div>

      <div class="info-item">
        <label>Created</label>
        <span>{{ grievance()!.createdAt | date:'medium' }}</span>
      </div>
    </div>

    <div class="description">
      <label>Description</label>
      <p>{{ grievance()!.description }}</p>
    </div>
  </mat-card>

  <!-- TIMELINE -->
  <mat-card class="timeline-card">
    <div class="timeline">

      <div class="progress-line"></div>

      <div
        class="timeline-step"
        [class.done]="isReached('Submitted')">
        <mat-icon>send</mat-icon>
        <span>Submitted</span>
      </div>

      <div
        class="timeline-step"
        [class.done]="isReached('Assigned')">
        <mat-icon>assignment_ind</mat-icon>
        <span>Assigned</span>
      </div>

      <div
        class="timeline-step"
        [class.done]="isReached('InReview')">
        <mat-icon>rate_review</mat-icon>
        <span>In Review</span>
      </div>

      <div
        class="timeline-step"
        [class.done]="isReached('Resolved')">
        <mat-icon>check_circle</mat-icon>
        <span>Resolved</span>
      </div>

      <div
        class="timeline-step"
        [class.done]="isReached('Closed')">
        <mat-icon>lock</mat-icon>
        <span>Closed</span>
      </div>

    </div>
  </mat-card>

  <!-- ESCALATED WARNING -->
  @if (grievance()!.isEscalated) {
    <mat-card class="escalated-box">
      <mat-icon color="warn">warning</mat-icon>
      <div>
        <strong>Escalated case</strong>
        <p>This grievance has been escalated for higher-level review.</p>
      </div>
    </mat-card>
  }

</div>
}
